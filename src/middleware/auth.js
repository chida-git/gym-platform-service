const jwt=require('jsonwebtoken');const JWT_SECRET=process.env.JWT_SECRET||'dev-secret-change-me';function requireAuth(req,res,next){const h=req.headers['authorization']||'';const m=h.match(/^Bearer\s+(.+)$/i);if(!m)return res.status(401).json({error:'Missing auth token'});try{req.partner=jwt.verify(m[1],JWT_SECRET);next()}catch(e){return res.status(401).json({error:'Invalid token'})}}module.exports={requireAuth};